# <!-- this_file: .accessibility.md -->
# Accessibility Guide for Vexy Stax JS

## Overview

Vexy Stax JS is a browser-based 3D image visualization tool. This guide documents accessibility features, keyboard navigation, and known limitations for users with disabilities.

**Target Compliance**: WCAG 2.1 Level AA (partially compliant - see limitations)

---

## Table of Contents

1. [Keyboard Navigation](#keyboard-navigation)
2. [Screen Reader Support](#screen-reader-support)
3. [Visual Accessibility](#visual-accessibility)
4. [Known Limitations](#known-limitations)
5. [Accessibility Testing](#accessibility-testing)
6. [Future Improvements](#future-improvements)

---

## Keyboard Navigation

### Primary Interface Controls

Vexy Stax JS provides **40+ keyboard shortcuts** for full application control without mouse interaction.

#### File Operations
- `Ctrl/Cmd + O` - Open file browser to load images
- `Ctrl/Cmd + E` - Export PNG at current camera view
- `Ctrl/Cmd + S` - Save current configuration to JSON
- `Ctrl/Cmd + Shift + S` - Copy configuration to clipboard
- `Delete` - Remove selected image from stack

#### View Controls
- `1` - Switch to Perspective camera mode
- `2` - Switch to Orthographic camera mode
- `3` - Switch to Isometric camera mode
- `4` - Switch to Telephoto camera mode
- `0` - Reset camera to default view

#### Viewpoint Presets
- `F` - Front view (face-on to image stack)
- `T` - Top view (bird's eye)
- `B` - Beauty angle (3/4 view for presentation)
- `S` - Side view (profile)
- `I` - Isometric view (technical drawing angle)
- `C` - Center content in viewport

#### History Controls
- `Ctrl/Cmd + Z` - Undo last change (10-level history)
- `Ctrl/Cmd + Shift + Z` - Redo undone change
- `Ctrl/Cmd + Y` - Redo (alternate binding)

#### Utility Shortcuts
- `H` - Show keyboard shortcuts help panel
- `Escape` - Close open dialogs/modals
- `?` - Toggle help overlay (if implemented)

#### Camera Manipulation (Mouse Required)
- Left Mouse Drag - Rotate camera around stack
- Right Mouse Drag - Pan camera position
- Mouse Wheel - Zoom in/out

**Note**: Camera orbit/pan/zoom currently require mouse or trackpad input. Touch gestures supported on tablet devices.

---

## Screen Reader Support

### Current Implementation Status

**⚠️ Limited Screen Reader Support**

Vexy Stax JS is primarily a visual 3D tool with limited semantic HTML structure. Screen reader users will face significant barriers.

#### Accessible Elements

**Application Title and Description**:
```html
<title>Vexy Stax JS - 3D Image Stack Visualizer</title>
<meta name="description" content="Browser-based Three.js tool for visualizing layered artwork in 3D space">
```

**Main Landmarks**:
- Navigation area (file controls, export buttons)
- Main content area (3D canvas)
- Complementary sidebar (Tweakpane UI controls)

**Semantic Structure**:
- `<main>` wrapper for primary application content
- `<nav>` for top-level file/export controls
- `<aside>` for Tweakpane parameter panel (right sidebar)

#### Elements Lacking Accessibility

**Three.js Canvas** (`<canvas>` element):
- No ARIA labels or alternative text
- No DOM-based alternative for 3D scene content
- Screen readers cannot access image stack order or Z-positions
- Camera position/rotation not exposed to assistive technology

**Tweakpane UI** (Parameter Controls):
- Third-party library with minimal ARIA support
- Input fields lack explicit labels in some cases
- Folder expand/collapse states not announced properly
- Slider values may not be announced on change

**Toast Notifications**:
- Visual-only feedback for file load errors, memory warnings
- No `role="alert"` or `aria-live` regions implemented
- Screen reader users miss critical error messages

#### Recommendations for Screen Reader Users

**Not Recommended For**:
- Users relying exclusively on screen readers
- Users requiring complete non-visual access to 3D content

**Limited Use Cases**:
- Loading files via keyboard (Ctrl+O) with file name confirmation
- Exporting images via keyboard (Ctrl+E) for later visual review
- Adjusting parameters in Tweakpane sidebar (with sighted assistance)

---

## Visual Accessibility

### Color Contrast

**UI Theme**: Dark theme (`#38383d` background, light text)
- Text contrast ratio: **12:1** (exceeds WCAG AAA requirement of 7:1)
- Button contrast: **4.8:1** (meets WCAG AA requirement of 4.5:1)
- Focus indicators: **6.2:1** (meets WCAG AA requirement)

**3D Scene**:
- Configurable background color (default: `#38383d`)
- User can adjust to high-contrast colors if needed
- Floor visibility: 1% opacity by default (can be increased)

### Focus Indicators

**Keyboard Focus Visible**: ✅ Yes
- Tweakpane inputs show blue outline on focus
- Buttons show outline on keyboard navigation
- Focus order follows visual layout (top to bottom, left to right)

**Focus Trap**: ⚠️ Partial
- Modal dialogs trap focus when open
- File browser dialog returns focus to trigger button
- No focus trap for main canvas area (focus can leave application)

### Text Scaling

**Browser Zoom**: ✅ Supported
- UI scales proportionally at 200% zoom (WCAG requirement)
- Tweakpane text remains readable at 400% zoom
- Canvas content scales with browser zoom
- No horizontal scrolling required at 200% zoom

**User Font Size Overrides**: ⚠️ Partial
- Tweakpane UI uses fixed font sizes (not responsive to browser default font size)
- Documentation (README, API) respects user font preferences

### Motion and Animation

**Animation Control**: ⚠️ Limited
- Camera animations respect `prefers-reduced-motion` CSS media query
- GSAP animations use reduced duration (200ms → 50ms) if motion preference detected
- No option to disable animations entirely in UI
- 3D scene continuously renders at 60fps (cannot disable without stopping application)

**Recommendation for Motion Sensitivity**:
- Set browser/OS to "Reduce motion" before loading application
- Use static viewpoint presets instead of animated camera moves
- Minimize use of camera rotation (triggers vestibular issues)

---

## Known Limitations

### Critical Accessibility Barriers

#### 1. **3D Canvas Not Accessible to Screen Readers**
**Impact**: Complete barrier for blind users
**Reason**: Three.js `<canvas>` is a bitmap rendering target with no DOM structure
**Workaround**: None available
**Future**: Requires alternative text description of scene (JSON export with annotations)

#### 2. **Mouse/Trackpad Required for Camera Control**
**Impact**: Keyboard-only users cannot rotate/pan/zoom camera
**Reason**: OrbitControls library designed for pointer input
**Workaround**: Use viewpoint presets (F/T/B/S/I keys) for fixed camera angles
**Future**: Implement keyboard-based camera control (arrow keys + modifiers)

#### 3. **Minimal ARIA Markup**
**Impact**: Screen readers lack context for UI controls
**Reason**: Tweakpane third-party library has limited accessibility features
**Workaround**: Sighted assistance recommended for parameter adjustments
**Future**: Contribute ARIA improvements to Tweakpane upstream project

#### 4. **No Alternative Content Descriptions**
**Impact**: Screen reader users cannot access image metadata
**Reason**: Images loaded as textures, no alt text storage
**Workaround**: Use JSON export to review image filenames
**Future**: Store alt text in JSON export, expose via ARIA labels

#### 5. **Visual-Only Feedback (Toast Notifications)**
**Impact**: Screen reader users miss error messages
**Reason**: No `aria-live` regions for dynamic notifications
**Workaround**: Check browser console for error messages
**Future**: Implement ARIA live regions for all toast notifications

### Partial Barriers

#### 6. **Touch Gestures Documentation Missing**
**Impact**: Tablet users uncertain how to interact
**Reason**: Documentation focuses on desktop keyboard/mouse
**Workaround**: Standard touch gestures work (pinch-to-zoom, two-finger pan)
**Future**: Add touch gesture documentation to README

#### 7. **High Memory Usage**
**Impact**: Users with cognitive disabilities may struggle with memory warnings
**Reason**: Large image files (10MB+) trigger memory warnings
**Workaround**: Use smaller images, close other browser tabs
**Future**: Improve memory warning clarity, add "lightweight mode"

---

## Accessibility Testing

### Recommended Testing Tools

#### Automated Testing
1. **axe DevTools** (Chrome/Firefox extension)
   - Install: https://www.deque.com/axe/devtools/
   - Run: Open DevTools → axe → Scan All of My Page
   - Expected Issues: Canvas accessibility, ARIA markup gaps

2. **WAVE** (Web Accessibility Evaluation Tool)
   - Install: https://wave.webaim.org/extension/
   - Run: Click WAVE icon in browser toolbar
   - Expected Issues: Missing alt text, structural landmarks

3. **Lighthouse Accessibility Audit** (Chrome DevTools)
   - Run: DevTools → Lighthouse → Accessibility
   - Expected Score: 70-80 (partial compliance)

#### Manual Testing Procedures

**Keyboard Navigation Test**:
```bash
# Test Steps:
1. Load application in browser
2. Press Tab repeatedly - verify focus visible on all interactive elements
3. Test all keyboard shortcuts (see list above)
4. Verify focus order is logical (top → bottom, left → right)
5. Confirm Escape key closes modals
6. Test undo/redo with Ctrl+Z / Ctrl+Shift+Z
```

**Screen Reader Test** (NVDA on Windows, VoiceOver on macOS):
```bash
# Test Steps:
1. Enable screen reader before loading application
2. Navigate application with Tab/Shift+Tab
3. Verify control labels are announced
4. Test form inputs in Tweakpane sidebar
5. Verify error messages are announced (expected: NOT announced - known issue)
6. Check canvas element announcement (expected: "canvas" only, no scene description)
```

**Color Contrast Test**:
```bash
# Manual Check:
1. Inspect UI text colors in DevTools
2. Use Color Contrast Analyzer: https://www.tpgi.com/color-contrast-checker/
3. Verify text contrast ≥ 4.5:1 (normal text), ≥ 3:1 (large text)
4. Test with browser dark mode enabled/disabled
```

**Zoom/Scaling Test**:
```bash
# Test Steps:
1. Set browser zoom to 200% (Ctrl/Cmd + Plus)
2. Verify no horizontal scrolling required
3. Verify all text remains readable
4. Test at 400% zoom (should be mostly readable)
5. Reset zoom (Ctrl/Cmd + 0)
```

**Motion Sensitivity Test**:
```bash
# Test Steps:
1. Enable "Reduce motion" in OS settings:
   - macOS: System Preferences → Accessibility → Display → Reduce motion
   - Windows: Settings → Ease of Access → Display → Show animations
2. Reload application
3. Trigger camera animation (press B for Beauty view)
4. Verify animation duration is reduced (should be <100ms)
```

### Testing Checklist for Contributors

Before submitting PRs with UI changes:

- [ ] Test all keyboard shortcuts still work
- [ ] Verify focus indicators visible on new controls
- [ ] Check color contrast ratio ≥ 4.5:1 for text
- [ ] Test with browser zoom at 200%
- [ ] Run axe DevTools scan (no new critical issues)
- [ ] Test with screen reader (NVDA/VoiceOver) - verify no regressions
- [ ] Verify prefers-reduced-motion respected for animations

---

## Future Improvements

### Planned Enhancements (Roadmap)

#### High Priority
1. **ARIA Live Regions for Toast Notifications**
   - Add `role="alert"` to notification containers
   - Implement `aria-live="polite"` for non-critical messages
   - Test with NVDA and VoiceOver

2. **Keyboard Camera Controls**
   - Arrow keys: Rotate camera (↑↓←→)
   - Shift + Arrow: Pan camera
   - Plus/Minus: Zoom in/out
   - Document in keyboard shortcuts help

3. **Canvas Alternative Text**
   - Generate text description of scene on image load
   - Include: image count, stack depth, current camera angle
   - Expose via `aria-label` on canvas element

#### Medium Priority
4. **Tweakpane ARIA Improvements**
   - Add explicit `<label>` elements for all inputs
   - Implement `aria-expanded` for folder states
   - Add `aria-valuetext` for slider values
   - Contribute changes upstream to Tweakpane library

5. **Touch Gesture Documentation**
   - Document pinch-to-zoom in README
   - Add two-finger pan gesture instructions
   - Include touch accessibility in BROWSER_COMPATIBILITY.md

6. **High Contrast Mode**
   - Detect `prefers-contrast: high` media query
   - Apply higher contrast UI theme automatically
   - Increase floor/background contrast for better depth perception

#### Low Priority
7. **Screencast Mode**
   - Generate spoken description of actions (via Web Speech API)
   - Announce file loads, camera changes, export completion
   - Toggle on/off in settings

8. **Lightweight Mode for Cognitive Accessibility**
   - Simplified UI with fewer controls
   - Larger buttons and text
   - Reduced visual complexity in 3D scene

---

## Resources

### Accessibility Standards
- **WCAG 2.1 Guidelines**: https://www.w3.org/WAI/WCAG21/quickref/
- **ARIA Authoring Practices**: https://www.w3.org/WAI/ARIA/apg/
- **WebGL Accessibility**: https://www.w3.org/WAI/GL/wiki/Techniques/canvas

### Testing Tools
- **axe DevTools**: https://www.deque.com/axe/devtools/
- **WAVE**: https://wave.webaim.org/
- **Color Contrast Analyzer**: https://www.tpgi.com/color-contrast-checker/
- **NVDA Screen Reader**: https://www.nvaccess.org/download/

### Related Documentation
- [UI Guide](.ui-guide.md) - Complete keyboard shortcut list
- [Browser Compatibility](BROWSER_COMPATIBILITY.md) - Supported browsers and features
- [Contributing Guide](CONTRIBUTING.md) - Accessibility testing checklist

---

## Feedback

Accessibility is an ongoing process. If you encounter barriers not documented here:

1. **Report issues**: https://github.com/vexyart/vexy-stax-js/issues
2. **Label as**: `accessibility` or `a11y`
3. **Include**:
   - Browser and assistive technology used
   - Steps to reproduce the barrier
   - Expected vs actual behavior
   - Suggested improvements (if any)

---

**Last Updated**: 2025-11-05
**Status**: Partial WCAG 2.1 Level AA compliance (see Known Limitations)
